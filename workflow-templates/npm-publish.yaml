---

# This GitHub Actions workflow is designed to be manually triggered via workflow_dispatch.
# The workflow delegates the actual NPM publishing process to the re-npm-publish.yml workflow
# from the qubership-workflow-hub repository, which performs the following tasks:
# 1. Checks out the repository.
# 2. Sets up Node.js environment.
# 3. Installs dependencies.
# 4. Detects if the project is a Lerna monorepo.
# 5. Updates dependencies if required.
# 6. Updates package version in package.json or lerna.json.
# 7. Builds the project.
# 8. Runs tests.
# 9. Commits and pushes changes.
# 10. Publishes the package to NPM registry.

# To make it work for your project, you need to adjust the package.json and add configuration file for GitHub release.
# Please find detailed instructions:
# https://github.com/netcracker/qubership-workflow-hub?tab=readme-ov-file#npm-project-release-workflow

name: Release NPM package

on:
  workflow_dispatch:
    inputs:
      release-version:
        description: 'Release version for NPM (e.g., 1.0.0)'
        required: false
        type: string
      npm-scope:
        description: 'NPM scope for the package'
        required: false
        type: string
        default: '@netcracker'
      npm-dist-tag:
        description: 'NPM distribution tag'
        required: false
        type: string
        default: 'latest'

permissions:
  contents: write
  packages: write

jobs:
  npm-publish:
    if: ${{ inputs.npm-publish && inputs.npm-publish != 'false' }}
    uses: Netcracker/qubership-workflow-hub/.github/workflows/re-npm-publish.yml@main
    with:
      version: ${{ inputs.release-version }}
      scope: ${{ inputs.npm-scope }}
      dist-tag: ${{ inputs.npm-dist-tag }}
      branch_name: main
    secrets: inherit
